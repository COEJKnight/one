from collections import OrderedDict
from sqlalchemy import cast, Date

from dataactcore.models.stagingModels import DetachedAwardProcurement, AwardProcurement

file_model = DetachedAwardProcurement
staging_model = AwardProcurement

mapping = OrderedDict([
    ('piid', 'piid'),
    ('awardingsubtieragencycode', 'awarding_sub_tier_agency_c'),
    ('awardingsubtieragencyname', 'awarding_sub_tier_agency_n'),
    ('awardingagencycode', 'awarding_agency_code'),
    ('awardingagencyname', 'awarding_agency_name'),
    ('parentawardid', 'parent_award_id'),
    ('awardmodificationamendmentnumber', 'award_modification_amendme'),
    ('typeofcontractpricing', 'type_of_contract_pricing'),
    ('contractawardtype', 'contract_award_type'),
    ('naics', 'naics'),
    ('naics_description', 'naics_description'),
    ('awardeeorrecipientuniqueidentifier', 'awardee_or_recipient_uniqu'),
    ('ultimateparentlegalentityname', 'ultimate_parent_legal_enti'),
    ('ultimateparentuniqueidentifier', 'ultimate_parent_unique_ide'),
    ('awarddescription', 'award_description'),
    ('primaryplaceofperformancezip_4', 'place_of_performance_zip4a'),
    ('primaryplaceofperformancecongressionaldistrict', 'place_of_performance_congr'),
    ('awardeeorrecipientlegalentityname', 'awardee_or_recipient_legal'),
    ('legalentitycityname', 'legal_entity_city_name'),
    ('legalentitystatedescription', 'legal_entity_state_descrip'),
    ('legalentityzip_4', 'legal_entity_zip4'),
    ('legalentitycongressionaldistrict', 'legal_entity_congressional'),
    ('legalentityaddressline1', 'legal_entity_address_line1'),
    ('legalentityaddressline2', 'legal_entity_address_line2'),
    ('legalentityaddressline3', 'legal_entity_address_line3'),
    ('legalentitycountrycode', 'legal_entity_country_code'),
    ('legalentitycountryname', 'legal_entity_country_name'),
    ('periodofperformancestartdate', 'period_of_performance_star'),
    ('periodofperformancecurrentenddate', 'period_of_performance_curr'),
    ('periodofperformancepotentialenddate', 'period_of_perf_potential_e'),
    ('orderingperiodenddate', 'ordering_period_end_date'),
    ('actiondate', 'action_date'),
    ('actiontype', 'action_type'),
    ('federalactionobligation', 'federal_action_obligation'),
    ('currenttotalvalueofaward', 'current_total_value_award'),
    ('potentialtotalvalueofaward', 'potential_total_value_awar'),
    ('fundingsubtieragencycode', 'funding_sub_tier_agency_co'),
    ('fundingsubtieragencyname', 'funding_sub_tier_agency_na'),
    ('fundingofficecode', 'funding_office_code'),
    ('fundingofficename', 'funding_office_name'),
    ('awardingofficecode', 'awarding_office_code'),
    ('awardingofficename', 'awarding_office_name'),
    ('referenced_idv_agency_identifier', 'referenced_idv_agency_iden'),
    ('fundingagencycode', 'funding_agency_code'),
    ('fundingagencyname', 'funding_agency_name'),
    ('primaryplaceofperformancelocationcode', 'place_of_performance_locat'),
    ('primaryplaceofperformancestatecode', 'place_of_performance_state'),
    ('primaryplaceofperformancecountrycode', 'place_of_perform_country_c'),
    ('idv_type', 'idv_type'),
    ('vendor_doing_as_business_name', 'vendor_doing_as_business_n'),
    ('vendor_phone_number', 'vendor_phone_number'),
    ('vendor_fax_number', 'vendor_fax_number'),
    ('multiple_or_single_award_idv', 'multiple_or_single_award_i'),
    ('type_of_idc', 'type_of_idc'),
    ('a76_fair_act_action', 'a_76_fair_act_action'),
    ('dod_claimant_program_code', 'dod_claimant_program_code'),
    ('clinger_cohen_act_planning_compliance', 'clinger_cohen_act_planning'),
    ('commercial_item_acquisition_procedures', 'commercial_item_acquisitio'),
    ('commercial_item_test_program', 'commercial_item_test_progr'),
    ('consolidated_contract', 'consolidated_contract'),
    ('contingency_humanitarian_or_peacekeeping_operation', 'contingency_humanitarian_o'),
    ('contract_bundling', 'contract_bundling'),
    ('contract_financing', 'contract_financing'),
    ('contracting_officer_determination_of_business_size', 'contracting_officers_deter'),
    ('cost_accounting_standards_clause', 'cost_accounting_standards'),
    ('cost_or_pricing_data', 'cost_or_pricing_data'),
    ('country_of_product_or_service_origin', 'country_of_product_or_serv'),
    ('davis_bacon_act', 'davis_bacon_act'),
    ('evaluated_preference', 'evaluated_preference'),
    ('extent_competed', 'extent_competed'),
    ('fedbizopps', 'fed_biz_opps'),
    ('foreign_funding', 'foreign_funding'),
    ('gfe_gfp', 'government_furnished_equip'),
    ('information_technology_commercial_item_category', 'information_technology_com'),
    ('interagency_contracting_authority', 'interagency_contracting_au'),
    ('local_area_set_aside', 'local_area_set_aside'),
    ('major_program', 'major_program'),
    ('purchase_card_as_payment_method', 'purchase_card_as_payment_m'),
    ('multi_year_contract', 'multi_year_contract'),
    ('national_interest_action', 'national_interest_action'),
    ('number_of_actions', 'number_of_actions'),
    ('number_of_offers_received', 'number_of_offers_received'),
    ('other_statutory_authority', 'other_statutory_authority'),
    ('performance_based_service_acquisition', 'performance_based_service'),
    ('place_of_manufacture', 'place_of_manufacture'),
    ('price_evaluation_adjustment_preference_percent_difference', 'price_evaluation_adjustmen'),
    ('product_or_service_code', 'product_or_service_code'),
    ('program_acronym', 'program_acronym'),
    ('other_than_full_and_open_competition', 'other_than_full_and_open_c'),
    ('recovered_materials_sustainability', 'recovered_materials_sustai'),
    ('research', 'research'),
    ('sea_transportation', 'sea_transportation'),
    ('service_contract_act', 'service_contract_act'),
    ('small_business_competitiveness_demonstration_program', 'small_business_competitive'),
    ('solicitation_identifier', 'solicitation_identifier'),
    ('solicitation_procedures', 'solicitation_procedures'),
    ('fair_opportunity_limited_sources', 'fair_opportunity_limited_s'),
    ('subcontracting_plan', 'subcontracting_plan'),
    ('program_system_or_equipment_code', 'program_system_or_equipmen'),
    ('type_set_aside', 'type_set_aside'),
    ('epa_designated_product', 'epa_designated_product'),
    ('walsh_healey_act', 'walsh_healey_act'),
    ('transaction_number', 'transaction_number'),
    ('sam_exception', 'sam_exception'),
    ('city_local_government', 'city_local_government'),
    ('county_local_government', 'county_local_government'),
    ('inter_municipal_local_government', 'inter_municipal_local_gove'),
    ('local_government_owned', 'local_government_owned'),
    ('municipality_local_government', 'municipality_local_governm'),
    ('school_district_local_government', 'school_district_local_gove'),
    ('township_local_government', 'township_local_government'),
    ('us_state_government', 'us_state_government'),
    ('us_federal_government', 'us_federal_government'),
    ('federal_agency', 'federal_agency'),
    ('federally_funded_research_and_development_corp', 'federally_funded_research'),
    ('us_tribal_government', 'us_tribal_government'),
    ('foreign_government', 'foreign_government'),
    ('community_developed_corporation_owned_firm', 'community_developed_corpor'),
    ('labor_surplus_area_firm', 'labor_surplus_area_firm'),
    ('corporate_entity_not_tax_exempt', 'corporate_entity_not_tax_e'),
    ('corporate_entity_tax_exempt', 'corporate_entity_tax_exemp'),
    ('partnership_or_limited_liability_partnership', 'partnership_or_limited_lia'),
    ('sole_proprietorship', 'sole_proprietorship'),
    ('small_agricultural_cooperative', 'small_agricultural_coopera'),
    ('international_organization', 'international_organization'),
    ('us_government_entity', 'us_government_entity'),
    ('emerging_small_business', 'emerging_small_business'),
    ('c8a_program_participant', 'c8a_program_participant'),
    ('sba_certified_8a_joint_venture', 'sba_certified_8_a_joint_ve'),
    ('dot_certified_disadvantaged_business_enterprise', 'dot_certified_disadvantage'),
    ('self_certified_small_disadvantaged_business', 'self_certified_small_disad'),
    ('historically_underutilized_business_zone_hubzone_firm', 'historically_underutilized'),
    ('small_disadvantaged_business', 'small_disadvantaged_busine'),
    ('the_abilityone_program', 'the_ability_one_program'),
    ('historically_black_college_or_university', 'historically_black_college'),
    ('c1862_land_grant_college', 'c1862_land_grant_college'),
    ('c1890_land_grant_college', 'c1890_land_grant_college'),
    ('c1994_land_grant_college', 'c1994_land_grant_college'),
    ('minority_institution', 'minority_institution'),
    ('private_university_or_college', 'private_university_or_coll'),
    ('school_of_forestry', 'school_of_forestry'),
    ('state_controlled_institution_of_higher_learning', 'state_controlled_instituti'),
    ('tribal_college', 'tribal_college'),
    ('veterinary_college', 'veterinary_college'),
    ('educational_institution', 'educational_institution'),
    ('alaskan_native_servicing_institution', 'alaskan_native_servicing_i'),
    ('community_development_corporation', 'community_development_corp'),
    ('native_hawaiian_servicing_institution', 'native_hawaiian_servicing'),
    ('domestic_shelter', 'domestic_shelter'),
    ('manufacturer_of_goods', 'manufacturer_of_goods'),
    ('hospital_flag', 'hospital_flag'),
    ('veterinary_hospital', 'veterinary_hospital'),
    ('hispanic_servicing_institution', 'hispanic_servicing_institu'),
    ('foundation', 'foundation'),
    ('woman_owned_business', 'woman_owned_business'),
    ('minority_owned_business', 'minority_owned_business'),
    ('women_owned_small_business', 'women_owned_small_business'),
    ('economically_disadvantaged_women_owned_small_business', 'economically_disadvantaged'),
    ('joint_venture_women_owned_small_business', 'joint_venture_women_owned'),
    ('joint_venture_economically_disadvantaged_women_owned_small_business', 'joint_venture_economically'),
    ('veteran_owned_business', 'veteran_owned_business'),
    ('service_disabled_veteran_owned_business', 'service_disabled_veteran_o'),
    ('contracts', 'contracts'),
    ('grants', 'grants'),
    ('receives_contracts_and_grants', 'receives_contracts_and_gra'),
    ('airport_authority', 'airport_authority'),
    ('council_of_governments', 'council_of_governments'),
    ('housing_authorities_public_tribal', 'housing_authorities_public'),
    ('interstate_entity', 'interstate_entity'),
    ('planning_commission', 'planning_commission'),
    ('port_authority', 'port_authority'),
    ('transit_authority', 'transit_authority'),
    ('subchapter_scorporation', 'subchapter_s_corporation'),
    ('limited_liability_corporation', 'limited_liability_corporat'),
    ('foreign_owned_and_located', 'foreign_owned_and_located'),
    ('american_indian_owned_business', 'american_indian_owned_busi'),
    ('alaskan_native_owned_corporation_or_firm', 'alaskan_native_owned_corpo'),
    ('indian_tribe_federally_recognized', 'indian_tribe_federally_rec'),
    ('native_hawaiian_owned_business', 'native_hawaiian_owned_busi'),
    ('tribally_owned_business', 'tribally_owned_business'),
    ('asian_pacific_american_owned_business', 'asian_pacific_american_own'),
    ('black_american_owned_business', 'black_american_owned_busin'),
    ('hispanic_american_owned_business', 'hispanic_american_owned_bu'),
    ('native_american_owned_business', 'native_american_owned_busi'),
    ('subcontinent_asian_asian_indian_american_owned_business', 'subcontinent_asian_asian_i'),
    ('other_minority_owned_business', 'other_minority_owned_busin'),
    ('for_profit_organization', 'for_profit_organization'),
    ('nonprofit_organization', 'nonprofit_organization'),
    ('other_not_for_profit_organization', 'other_not_for_profit_organ'),
    ('us_local_government', 'us_local_government'),
    ('referenced_idv_modification_number', 'referenced_idv_modificatio'),
    ('undefinitized_action', 'undefinitized_action'),
    ('domestic_or_foreign_entity', 'domestic_or_foreign_entity'),
    ('lastmodifieddate', 'last_modified'),
    ('primaryplaceofperformancecityname', 'place_of_perform_city_name')
])


def query_data(session, agency_code, start, end):
    rows = session.query(file_model).\
        filter(file_model.awarding_agency_code == agency_code).\
        filter(cast(file_model.action_date, Date) > start).\
        filter(cast(file_model.action_date, Date) < end)
    session.commit()
    return rows
